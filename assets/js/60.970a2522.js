(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{582:function(e,s,a){"use strict";a.r(s);var t=a(6),n=Object(t.a)({},(function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h2",{attrs:{id:"项目源码地址"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#项目源码地址"}},[e._v("#")]),e._v(" 项目源码地址")]),e._v(" "),a("p",[e._v("后端源码："),a("a",{attrs:{href:"https://github.com/Rackar/node_blog",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/Rackar/node_blog"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("前端源码："),a("a",{attrs:{href:"https://github.com/Rackar/node_blog_vue",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/Rackar/node_blog_vue"),a("OutboundLink")],1)]),e._v(" "),a("h2",{attrs:{id:"系列文章地址"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#系列文章地址"}},[e._v("#")]),e._v(" 系列文章地址")]),e._v(" "),a("p",[a("a",{attrs:{href:"./nodeStart1"}},[e._v("基础环境搭建")])]),e._v(" "),a("p",[a("a",{attrs:{href:"./nodeStart2"}},[e._v("后端起步")])]),e._v(" "),a("p",[a("a",{attrs:{href:"./nodeStart3"}},[e._v("前端起步")])]),e._v(" "),a("h2",{attrs:{id:"用-express-脚手架初始化项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用-express-脚手架初始化项目"}},[e._v("#")]),e._v(" 用 express 脚手架初始化项目")]),e._v(" "),a("p",[e._v("（如使用 git clone 拉取我的代码，这步就不用做了）")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("npm install express-generator -g\nexpress node_blog\ncd node_blog\nnpm install\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])]),a("h2",{attrs:{id:"安装-mongoose"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装-mongoose"}},[e._v("#")]),e._v(" 安装 Mongoose")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("npm install mongoose\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("连接数据交给 mongoose，然后按照类似下面这种方式建立 User 模型，之后引入模型然后 find、save、update 就好。"),a("a",{attrs:{href:"https://www.jianshu.com/p/b9a8a89f6c9f",target:"_blank",rel:"noopener noreferrer"}},[e._v("参考简书"),a("OutboundLink")],1)]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("var mongoose = require(\"./index\");\nvar Schema = mongoose.Schema;\n\nvar UserSchema = new Schema({\n    name: {type: String},\n    mobile: {type: String},\n    pwd: {type: String}\n});\nmodule.exports = mongoose.model('User', UserSchema);\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br")])]),a("h2",{attrs:{id:"安装-jwt"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装-jwt"}},[e._v("#")]),e._v(" 安装 jwt")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/qq_30604453/article/details/85060077",target:"_blank",rel:"noopener noreferrer"}},[e._v("参考 csdn"),a("OutboundLink")],1),e._v("\n安装"),a("code",[e._v("npm install jsonwebtoken")]),e._v("\n使用")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("token = jwt.sign({id=0}, 'tokenSecret', {expiresIn:time} //生成token加密字符串\nresult = jwt.verify(token, 'tokenSecret') //验证\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("一些坑：")]),e._v(" "),a("h2",{attrs:{id:"解决跨域问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决跨域问题"}},[e._v("#")]),e._v(" 解决跨域问题")]),e._v(" "),a("p",[e._v("要允许域，要允许 header，要处理 option 请求。")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("app.all('*', function (req, res, next) {\n  res.header('Access-Control-Allow-Origin', '*');\n  //Access-Control-Allow-Headers ,可根据浏览器的F12查看,把对应的粘贴在这里就行。jwt需Authorization\n  res.header('Access-Control-Allow-Headers', 'Origin,X-Requested-With,Content-Type,Accept,Authorization');\n  res.header('Access-Control-Allow-Methods', '*');\n  res.header('Content-Type', 'application/json;charset=utf-8');\n\n  //header头信息设置结束后，结束程序往下执行，如果是options请求，直接返回204允许浏览器紧接着发复杂请求\n  if (req.method.toLocaleLowerCase() === 'options') {\n    res.status(204);\n    return res.json({}); //直接返回空数据，结束此次请求\n  } else {\n    next();\n  }\n});\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br")])]),a("h2",{attrs:{id:"jwt-前后端一致问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jwt-前后端一致问题"}},[e._v("#")]),e._v(" jwt 前后端一致问题")]),e._v(" "),a("p",[e._v("前端加了 Bearer +空格，后端就需要用.split(' ')[1]去")]),e._v(" "),a("h2",{attrs:{id:"设计数据表结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设计数据表结构"}},[e._v("#")]),e._v(" 设计数据表结构")]),e._v(" "),a("p",[e._v("按照 mongodb 尽量不连表查询的原则，只设计两个表，用户信息表和文章表。")])])}),[],!1,null,null,null);s.default=n.exports}}]);