(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{501:function(s,t,a){"use strict";a.r(t);var r=a(0),n=Object(r.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("（再次）又到了一年一度的云服务器过期时间，搬迁和环境搭建又得重搞一下了。这回是 php, mysql 和 wordpress.")]),s._v(" "),t("h2",{attrs:{id:"原配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#原配置"}},[s._v("#")]),s._v(" 原配置")]),s._v(" "),t("p",[s._v("使用了秋水逸冰的 lamp.sh, 文档和相关目录见 https://lamp.sh/faq.html")]),s._v(" "),t("h2",{attrs:{id:"mysql8"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql8"}},[s._v("#")]),s._v(" MySQL8")]),s._v(" "),t("p",[s._v("首先 phpmyadmin 进不去。发现是权限问题。目录权限需改 755")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cd /data/www/default/\nchmod -R 755 phpmyadmin\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("然后是密码忘记了，需要重置 MySQL 的密码。由于 MySQL8 的修改方式有变，百度的几种方法都不适用。")]),s._v(" "),t("div",{staticClass:"language-s line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("vi /etc/my.cnf\n# [mysqld]后加入\nskip-grant-tables\n\n#重启\nservice mysqld restart\n\nmysql -u root -p\n# 回车 这样可以免密码登录，但是修改手段都会被禁止\nFLUSH PRIVILEGES;\nALTER USER 'root'@'localhost' IDENTIFIED BY '123456';\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("详细见"),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/resetting-permissions.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"备份-wordpress-文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#备份-wordpress-文件"}},[s._v("#")]),s._v(" 备份 wordpress 文件")]),s._v(" "),t("p",[s._v("/data/www/default 全部文件拷贝")]),s._v(" "),t("h2",{attrs:{id:"宝塔面板wp迁移"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#宝塔面板wp迁移"}},[s._v("#")]),s._v(" 宝塔面板WP迁移")]),s._v(" "),t("p",[s._v("用了宝塔，迁移Wordpress轻松多了。如果修改了端口忘记了宝塔管理面板入口，可以ssh登陆后输入\n"),t("code",[s._v("sudo /etc/init.d/bt default")]),s._v(" 查看地址和用户密码。")]),s._v(" "),t("p",[s._v("新机器安装宝塔面板 https://www.bt.cn/ 或者使用宝塔镜像")]),s._v(" "),t("p",[s._v("防火墙放行8888")]),s._v(" "),t("p",[s._v("进入ip:8888默认端口，一键安装Nginx,php,mysql")]),s._v(" "),t("p",[s._v("进入软件商店，一键部署，安装wordpress，指定域名或路径")]),s._v(" "),t("p",[s._v("由于宝塔会添加防火墙，所以还需要放行端口:[54125]和[10044] for outline")]),s._v(" "),t("hr"),s._v(" "),t("h3",{attrs:{id:"插播腾讯云秘钥登陆"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#插播腾讯云秘钥登陆"}},[s._v("#")]),s._v(" 插播腾讯云秘钥登陆")]),s._v(" "),t("h2",{attrs:{id:"轻量级服务器-关机轻量级-秘钥-创建-已有-复制coding-pub绑定秘钥-服务器服务器开机winscp-高级-秘钥-coding-ppk-使用root登陆"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#轻量级服务器-关机轻量级-秘钥-创建-已有-复制coding-pub绑定秘钥-服务器服务器开机winscp-高级-秘钥-coding-ppk-使用root登陆"}},[s._v("#")]),s._v(" 轻量级服务器-关机"),t("br"),s._v("\n轻量级-秘钥-创建-已有，复制coding.pub"),t("br"),s._v("\n绑定秘钥-服务器"),t("br"),s._v("\n服务器开机"),t("br"),s._v("\nwinscp-高级-秘钥-coding.ppk 使用root登陆")]),s._v(" "),t("p",[s._v("继续迁移")]),s._v(" "),t("p",[s._v("旧机器 宝塔-数据库-wp-备份，新机器 导入")]),s._v(" "),t("p",[s._v("旧机器 scp拷贝wp-content目录和wp-includes，上传新机器")]),s._v(" "),t("p",[s._v("wp注意固定链接格式，并给宝塔添加伪静态支持：网站-站点-伪静态-选择wordpress-保存")]),s._v(" "),t("p",[s._v("给图片上传权限 "),t("code",[s._v("sudo chmod -R 755 wp-content/")])]),s._v(" "),t("p",[s._v("如果xmlrpc权限没打开，搜索教程打开wp权限")])])}),[],!1,null,null,null);t.default=n.exports}}]);