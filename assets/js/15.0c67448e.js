(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{410:function(s,a,t){s.exports=t.p+"assets/img/1630375141602.7d85facb.png"},411:function(s,a,t){s.exports=t.p+"assets/img/1630375395250.c6995be0.png"},412:function(s,a){s.exports="data:image/png;base64,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"},494:function(s,a,t){"use strict";t.r(a);var n=t(0),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("在未联网 Windows 工作站上，经常有大量数据筛选和拷贝的场景。部署和调试 Node.js 太过麻烦，准备捡起命令行脚本，使用 PowerShell 进行编程和批处理。")]),s._v(" "),a("h2",{attrs:{id:"基础命令测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基础命令测试"}},[s._v("#")]),s._v(" 基础命令测试")]),s._v(" "),a("p",[s._v("把最基本的命令记录一下。")]),s._v(" "),a("h3",{attrs:{id:"获取命令帮助"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取命令帮助"}},[s._v("#")]),s._v(" 获取命令帮助")]),s._v(" "),a("p",[s._v("这个比较有用，比起一个个搜索，使用时还是看一下具体命令帮助，能有个功能和参数的基本认识。")]),s._v(" "),a("p",[a("code",[s._v("help CODE -Full")])]),s._v(" "),a("p",[s._v("比如查看当前目录命令："),a("code",[s._v("help dir -Full")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(410),alt:"1630375141602.png"}})]),s._v(" "),a("p",[s._v("可以看到原命令名为 Get-ChildItem，不想分页就用这个命令原名, 有相关语法和参数，同时别名为 gci, ls, dir。")]),s._v(" "),a("p",[s._v("对具体某个参数如 Name 可以使用 Parameter")]),s._v(" "),a("p",[a("code",[s._v("help Get-Help -Parameter Name")])]),s._v(" "),a("h3",{attrs:{id:"获取子目录下的某些文件名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取子目录下的某些文件名"}},[s._v("#")]),s._v(" 获取子目录下的某些文件名")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-childitem?view=powershell-7.1",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),a("OutboundLink")],1)]),s._v(" "),a("ul",[a("li",[a("p",[s._v("遍历本目录及 1 级子目录下的以 BJ1,BJ2 开头的所有文件。"),a("br"),s._v(" "),a("code",[s._v("dir BJ1*,BJ2* -Depth 1")]),a("br"),s._v("\n或者 "),a("code",[s._v("dir -Include BJ1*,BJ2* -Depth 1")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(411),alt:"1630375395250.png"}})])]),s._v(" "),a("li",[a("p",[s._v("遍历本目录下所有文件，只要相对目录和名称"),a("br"),s._v(" "),a("code",[s._v("dir * -Depth 1 -Name")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(412),alt:"1630377285755.png"}})])]),s._v(" "),a("li",[a("p",[s._v("只遍历文件夹可以加 -Directory\n但是要注意递归时有坑。"),a("br"),s._v(" "),a("code",[s._v("dir * -Directory -Name")]),s._v("显示子目录列表"),a("br"),s._v(" "),a("code",[s._v("dir * -Depth 1 -Directory -Name")]),s._v(" 只显示子目录"),a("strong",[s._v("下级子目录")]),s._v("列表"),a("br"),s._v(" "),a("code",[s._v("dir ./ -Depth 1 -Directory -Name")]),s._v(" 这个把两级目录都显示出来")])]),s._v(" "),a("li",[a("p",[s._v("只要一使用 -Name ，子文件夹深度递归参数就会有些奇怪。要注意："),a("br"),s._v("\n使用"),a("code",[s._v("dir -Include *.tif -Depth 1 -Name")]),s._v("查询为空，"),a("br"),s._v("\n使用"),a("code",[s._v("dir * -Include *.tif -Depth 1 -Name")]),s._v("，查询到 3 个值。注意递归使用*，匹配特定文件名加 Include.")])]),s._v(" "),a("li",[a("p",[s._v("结论 1：遍历下两层的所有 tif\n"),a("code",[s._v("dir -Include *.tif -Depth 2 -Name")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("dir1.tif\nBuChong\\dir2.tif\nBuChong\\BJ1\\BJ1.TIF\nIndexData\\dir2.tif\nZhengJing\\BJ2\\BJ2.TIF\nZhengJing\\BJ3\\BJ3.TIF\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])])]),s._v(" "),a("h3",{attrs:{id:"robocopy-用法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#robocopy-用法"}},[s._v("#")]),s._v(" ROBOCOPY 用法")]),s._v(" "),a("p",[s._v("robocopy 在 window 下是默认安装的，有测评说横向比较复制最快。来看下用法")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("robocopy ./ ../cp *.tif")]),a("br"),s._v("\n只拷贝了 dir1.tif")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("robocopy ./ ../cp *.tif /s")]),a("br"),s._v("\n拷贝了全部*.tif 和相应的子目录")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("robocopy ./ ../cp *.tif /e")]),a("br"),s._v("\n拷贝了全部*.tif 和相应的子目录，并且还拷贝了其他不含*.tif 的空目录出来。也就是说复制了全部的文件夹结构，然后拷贝了目标文件。")])])]),s._v(" "),a("h3",{attrs:{id:"变量和赋值"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#变量和赋值"}},[s._v("#")]),s._v(" 变量和赋值")]),s._v(" "),a("p",[s._v("执行命令并赋值"),a("br"),s._v(" "),a("code",[s._v("$names = (dir -Include *.tif -Depth 2 -Name)")])]),s._v(" "),a("p",[s._v("引用值"),a("br"),s._v(" "),a("code",[s._v("$names")])]),s._v(" "),a("p",[s._v("遍历"),a("br"),s._v(" "),a("code",[s._v("foreach ($name in $names){echo $name','}")])]),s._v(" "),a("p",[s._v("将多行连成一行"),a("br"),s._v(" "),a("code",[s._v('$single = $names -join ","')])]),s._v(" "),a("p",[s._v("如果要替换分隔符的话"),a("br"),s._v(" "),a("code",[s._v('$single =$single -replace ","," "')])]),s._v(" "),a("h3",{attrs:{id:"组合拷贝"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#组合拷贝"}},[s._v("#")]),s._v(" 组合拷贝")]),s._v(" "),a("p",[s._v("拿到了文件名列表，组合拷贝命令")]),s._v(" "),a("p",[a("code",[s._v("robocopy ./ ../cp $single /e")]),s._v("\n失败，看来不能带路径")]),s._v(" "),a("p",[s._v("继续操作数组，提取文件名部分")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$total")]),s._v("=@"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("foreach")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$name")]),s._v(" in "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$names")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$text")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$name")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("split "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\\\"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$total")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$text")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$files")]),s._v("= "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$total")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-join")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[a("code",[s._v("robocopy ./ ../cp $files /e")])]),s._v(" "),a("p",[s._v("结果目录复制过来了，但是文件没过来。看来想当然了，以为用空格分割的字符串做为参数传入，就和手敲的表现一致。但是 ps 应该把整个含空格的字符串解析成一个文件名过滤字符串了。所以果断用回数组：")]),s._v(" "),a("p",[a("code",[s._v("robocopy ./ ../cp $total /e")])]),s._v(" "),a("p",[s._v("复制成功，达到预期目标。")]),s._v(" "),a("h2",{attrs:{id:"编写脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编写脚本"}},[s._v("#")]),s._v(" 编写脚本")]),s._v(" "),a("p",[s._v("该有的核心代码都备齐了，为了方便使用，将它封装为 cmdlet，输入参数为原目录，目标目录，是否全部复制开关参数，待选文件名列表的位置。")]),s._v(" "),a("p",[s._v("新建 myScript.ps1")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Copy-SatData")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("<#\n.SYNOPSIS\n    拷贝和筛选数据.\n\n.DESCRIPTION\n    通过列表文件批量拷贝和筛选数据.\n\n.PARAMETER SourceDir\n    待拷贝数据所在的目录.\n\n.PARAMETER DesDir\n    要拷贝去的新目录.\n\n.EXAMPLE\n     Copy-SatData -SourceDir D:/data -DesDir E:/data\n\n.EXAMPLE\n     Copy-SatData -SourceDir D:/data -DesDir E:/data -List E:/list.txt\n\n.EXAMPLE\n     Copy-SatData -SourceDir D:/data -DesDir E:/data -List E:/list.txt -Folder\n\n.INPUTS\n    String\n\n.OUTPUTS\n    String\n\n.NOTES\n    Author:  Rackar\n#>")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[CmdletBinding()]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#<<-- This turns a regular function into an advanced function")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("param")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[Parameter(Mandatory)]")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[string]")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SourceDir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[Parameter(Mandatory)]")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[string]")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DesDir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[string]")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$List")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[string[]]")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$Fileter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[Switch]")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$Folder")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#开关参数无需赋值")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$Folder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SourceDir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-ne")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-and")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SourceDir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-ne")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\\\'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SourceDir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/'")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DesDir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-ne")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-and")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DesDir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-ne")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\\\'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DesDir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/'")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$filelist")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Get-Content")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$List")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("foreach")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$name")]),s._v(" in "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$filelist")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$cmd")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"robocopy '),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SourceDir")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$name")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DesDir")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$name")]),s._v(' /s"')]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Invoke-Expression")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$cmd")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$filelist")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Get-Content")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$List")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$cmd")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"robocopy '),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SourceDir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DesDir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$filelist")]),s._v(' /e"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Invoke-Expression")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$cmd")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br")])]),a("p",[s._v("用法:")]),s._v(" "),a("div",{staticClass:"language-ps line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#首先加载函数\n. ./myScript.ps1\n#拷贝文件列表\nCopy-SatData -SourceDir E:\\wsNodejs\\image_grid\\dom -DesDir E:\\wsNodejs\\image_grid\\cp -List E:\\wsNodejs\\image_grid\\dom\\list.txt\n#拷贝文件夹列表\nCopy-SatData -SourceDir E:\\wsNodejs\\image_grid\\dom -DesDir E:\\wsNodejs\\image_grid\\cp -List E:\\wsNodejs\\image_grid\\dom\\list2.txt -Folder\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("拷贝嵌套子目录下的特定文件列表，可使用通配符："),a("br"),s._v("\nlist.txt:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("dir1.tif\ndir2.tif\nBJ*.TIF\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("拷贝特定子目录们下的所有文件："),a("br"),s._v("\nlist2.txt:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("BuChong\nZhengJing\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("工具制作完成，每次还需要手动执行才能使用，还是把他放入全局目录，方便直接调用。")]),s._v(" "),a("h2",{attrs:{id:"安装脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装脚本"}},[s._v("#")]),s._v(" 安装脚本")]),s._v(" "),a("p",[s._v("创建 install.ps1")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("$mpath = ($env:PSModulePath -Split ';')[0]+\"/Copy-Data\"\nmkdir $mpath\ncp ./CopySatData.psm1 $mpath\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("如果需要简写以方便使用，输入 sal mcp Copy-Data，这样 mcp 就是别名，可以直接用。但是下次打开 PS 又需要重新设置别名。如果需要永久修改：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#先创建个人配置文件\nNew-Item -Type file $profile\n#写入一行命令到配置中\nSet-Content $profile 'sal mcp Copy-Data'\n#查看\ncat $profile\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("没问题的话别名配置就生效了，打开新的 PS 窗口，输入 mcp，已提示管道参数。")]),s._v(" "),a("p",[s._v("至此制作列表文件并拷贝已完成。遍历文件的相关命令还没用上，等待进一步完善。")]),s._v(" "),a("h2",{attrs:{id:"编码问题导致中文乱码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编码问题导致中文乱码"}},[s._v("#")]),s._v(" 编码问题导致中文乱码")]),s._v(" "),a("p",[s._v("由于 PowerShell 默认配置 GBK 编码，所以通过 UTF-8 编码写入的脚本中的中文会成为乱码。"),a("br"),s._v("\n解决方法 1，修改本机 PowerShell 代码页的配置为 UTF-8。"),a("br"),s._v("\n解决方法 2：通过 GBK 编码打开脚本文件，保存成 GBK 编码格式。")]),s._v(" "),a("h2",{attrs:{id:"读写-xml"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#读写-xml"}},[s._v("#")]),s._v(" 读写 XML")]),s._v(" "),a("p",[s._v("https://www.pstips.net/loading-and-processing-xml-files.html")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# $xmldata = (Get-Content .\\GF1140579920190502Y.XML -encoding UTF8)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$xmldata")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[xml]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Get-Content")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\\GF1C_PMS_E119_7_N42_4_20210519_L1A1021754946_ORTHO_MS_pix"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("img"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("xml "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("encoding UTF8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$lineage")]),s._v("="),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$xmldata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("metadata"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Esri"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DataProperties"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lineage\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$projc")]),s._v("="),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$lineage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Process")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$projc")]),s._v("="),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$lineage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Process")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Where-Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-match")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"投影栅格"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$text")]),s._v(" ="),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$projc")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'#text'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$string")]),s._v(" ="),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$text")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("split "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$head")]),s._v(" ="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'<?xml version="1.0" encoding="UTF-8"?>\\r\\n<PAMDataset>\\r\\n<SRS>\\r\\n\'')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$tail")]),s._v(" ="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\r\\n</SRS>\\r\\n</PAMDataset>'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$result")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$head")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$string")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$tail")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$filename")]),s._v("="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"GF2dflksjdfiosdjf"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.xml'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$result")]),s._v(" > "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$filename")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# xml格式读取，修改，转string，带格式保存")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$xml")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("New-Object")]),s._v(" xml\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$xml")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("PreserveWhitespace = "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("$true")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$xml")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Load"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$pwd")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Path+"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/templete.xml'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$xml")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Metadatafile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("BasicDataContent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("MetaDataFileName = "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bbb"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$xml")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("OuterXml >xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("xml\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("h2",{attrs:{id:"参考文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文档"}},[s._v("#")]),s._v(" 参考文档")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/powershell/module/microsoft.powershell.core/about/about_modules?view=powershell-7.1",target:"_blank",rel:"noopener noreferrer"}},[s._v("模块化官方文档"),a("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);